
# volatile 和 可见性
对于 volatile 变量，当对 volatile 变量进行写操作时，JVM 会向处理器发送一条 lock 前缀的指令，将这个缓存中的变量会写到系统主存中。

所以，如果一个变量被 volatile 所修饰的话，在每次数据变化之后，其值都会被强制刷入主存。而其他处理器的缓存由于遵守了缓存一致性协议，也会吧这个变量的值从主存加载到自己的缓存。这就保证了 volatile 在并发编程中，其值在多个缓存中是可见的。


# volatile 和 有序性
volatile 除了可以保证数据的可见性之外，还有一个强大的功能，那就是可以禁止指令重排优化等。

普通变量仅仅会保证该方法的执行过程中所依赖的赋值结果的地方都能获得正确的结果，而不能保证变量的赋值操作和程序代码中的执行顺序一致。

**volatile 是通过内存屏障来禁止指令重排**，这就保证了代码的程序会严格按照代码的先后顺序执行。这就保证了有序性。被 volatile 修饰的变量的操作，会严格按照代码顺序执行，load -> add -> save 的执行顺序就是：load、add、save