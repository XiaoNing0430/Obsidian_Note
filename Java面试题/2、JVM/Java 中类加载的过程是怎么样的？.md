
Java中类的加载阶段分为加载（Loading）、链接（Linking）、初始化（Initialization）。其中链接过程包含了验证、准备、解析

![[Pasted image 20240425150005.png]]

# 加载阶段

加载阶段的目的是将类的 .class 文件加载到 JVM 中。在这个阶段 JVM 会根据类的全限定名获取定义该类的二进制字节流，并将这个字节流所代表的静态存储结构转换为方法区的运行时数据结构。

加载过程会创建一个 java.lang.Class 类的实例来表示这个类。这个 Class 对象作为程序中每个类的数据访问入口。


# 链接阶段

在链接阶段，java类加载器对类进行验证、准备、解析操作。将类与类的关系（符号引用转为直接引用）确定好，校验字节码

1. **验证**：校验类的正确性（文件格式、元数据、字节码、二进制兼容性），保证类的结构符合 JVM 规范
2. **准备**：为类变量分配内存并设置类变量的默认初始值，这些变量使用的内存都在方法区中分配。
3. **解析**：把类的符号引用转为直接引用（类、接口、字段、类方法、接口方法、方法类型、方法句柄、访问控制修饰符）


# 初始化阶段

初始化阶段是执行类构造器 **`<clinit>()`** 方法的过程。这里利用了一种懒加载的思想，所有 java虚拟机实现必须在每个类或接口被java程序首次主动使用才初始化，但类加载不一定，静态代码块在类**初始化**时执行 